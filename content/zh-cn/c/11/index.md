---
title: 'Day11 - 随机数'
---

在 C 语言中，生成随机数的功能主要通过标准库提供的两个函数来实现：`rand()` 和 `srand()`。它们分别用于生成随机数和设置随机数的种子。

## `rand()` 函数

`rand()` 函数用于生成一个伪随机数，它的返回值是一个整型数，范围从 `0` 到 `RAND_MAX`。`RAND_MAX` 是一个常量，表示 `rand()` 函数可以生成的最大值，其具体数值通常为 `32767`，但是它的具体值依赖于系统。

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    // 生成一个随机数
    int num = rand();
    printf("随机数：%d\n", num);
    return 0;
}
```

## `srand()` 函数

由于 `rand()` 函数是伪随机的，每次程序运行时生成的随机数序列是相同的。为了使随机数的生成序列不同，可以使用 `srand()` 函数为随机数生成器设置一个种子。通常，使用系统当前时间（通过 `time(NULL)`）作为种子来确保每次运行时生成的随机数不同。

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main() {
    // 设置随机数种子
    srand(time(NULL));

    // 生成一个随机数
    int num = rand();
    printf("随机数：%d\n", num);
    return 0;
}
```

在这段代码中，`srand(time(NULL))` 用当前时间设置了种子，使得每次运行程序时生成的随机数都不同。`time(NULL)` 返回当前的时间戳（秒数），这是一个不断变化的值。

## 限制随机数的范围

`rand()` 返回的是一个介于 `0` 和 `RAND_MAX` 之间的整数。如果你需要限制随机数在一个特定的范围内，可以使用取余运算符 `%` 或结合加法来调整。

### 示例：生成一个范围在 `min` 到 `max` 之间的随机数

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main() {
    // 设置随机数种子
    srand(time(NULL));

    // 定义范围
    int min = 1;
    int max = 100;

    // 生成范围在 [min, max] 之间的随机数
    int num = rand() % (max - min + 1) + min;
    printf("随机数：%d\n", num);
    return 0;
}
```

在这段代码中，`rand() % (max - min + 1) + min` 确保了随机数会在 `min` 到 `max` 范围内。例如，如果 `min = 1` 和 `max = 100`，那么生成的随机数将会是 `[1, 100]` 之间的一个整数。

## 注意事项

- **伪随机性**：`rand()` 生成的随机数是伪随机的，意味着它们并非完全随机，而是通过一定的算法生成的，看起来很随机，但实际上可以通过种子值推算出来。如果需要更高质量的随机数，可以使用更复杂的库，比如 `rand_s` 或 `mt19937` 算法（使用 C++ 的 `<random>` 库）。
- **RAND_MAX 的值**：`RAND_MAX` 是系统限定的，因此在不同的系统中，`rand()` 的最大返回值可能不同。一般情况下，`RAND_MAX` 是一个大约 `32767` 的常数。
- **线程安全**：`rand()` 和 `srand()` 不是线程安全的。如果你需要在多线程环境中生成随机数，建议使用线程安全的库，如 POSIX 的 `rand_r()` 或者 C11 的 `<stdalign.h>` 中的 `random()` 和 `srandom()` 函数。

## 使用更高质量的随机数（C11 及以上）

如果你正在使用 C11 或更高版本的标准，C 标准库提供了更高质量的随机数生成函数：

- `rand()` 仍然可以使用，但在 C11 之后推荐使用更现代的随机数生成方法。
- 使用 `random()` 和 `srandom()`，它们提供更好的随机性。

## 总结

- 使用 `rand()` 生成伪随机数。
- 使用 `srand()` 设置随机数的种子，通常结合 `time(NULL)` 来确保每次程序运行时生成不同的随机数。
- 使用取余操作调整随机数的范围。
